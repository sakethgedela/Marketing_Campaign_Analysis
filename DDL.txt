-- Database
CREATE DATABASE CAMPAIGN;

-- Accessing the database
USE CAMPAIGN;

-- Table Creation Queries

-- City table
CREATE TABLE City (
  City_Id int PRIMARY key,
  City_Name varchar(64) NOT NULL,
  State varchar(64) NOT NULL,
  CityTier int NOT NULL
);

-- Customer Table
CREATE TABLE Customer (
  Customer_Id varchar(8) PRIMARY KEY,
  Name varchar(128) NOT NULL,
  Gender char NOT NULL,
  City_Id int,
  Pincode int,
  Birthdate date,
  income_bracket float,
  emailId varchar(256),
  PhoneNo char(14),
  FOREIGN KEY (City_Id) REFERENCES City(City_Id)
);

-- Campaign table
CREATE TABLE Campaign (
  campaign_id varchar(32) PRIMARY KEY,
  campaignType varchar(128) NOT NULL,
  start_date date NOT NULL,
  end_date date NOT NULL
);

-- Item table
CREATE TABLE Item (
  Item_Id varchar(32) PRIMARY KEY,
  Item_Name varchar(45) NOT NULL,
  Item_Category varchar(128) NOT NULL,
  Price int NOT NULL
);

-- CouponMapping TABLE
CREATE TABLE CouponMapping (
  coupon_id varchar(32) PRIMARY KEY,
  item_id varchar(32),
  couponType varchar(128) NOT NULL,
  Value float NOT NULL,
  Min_Purchase float NOT NULL,
  Expiry int NOT NULL,
  FOREIGN KEY (item_id) REFERENCES Item (Item_Id)
);

-- CustomerTransactionData Table
CREATE TABLE CustomerTransactionData (
  Trans_Id varchar(32) PRIMARY KEY,
  Cust_Id varchar(8),
  item_id varchar(32) ,
  campaign_id varchar(32) ,
  coupon_id varchar(32) ,
  quantity int NOT NULL,
  PurchasingAmt float NOT NULL,
  PurchaseDate date NOT NULL,
  OrderType varchar(45) NOT NULL,
  FOREIGN KEY (campaign_id) REFERENCES Campaign (campaign_id),
  FOREIGN KEY (coupon_id) REFERENCES CouponMapping (coupon_id),
  FOREIGN KEY (Cust_Id) REFERENCES Customer (Customer_Id),
  FOREIGN KEY (item_id) REFERENCES Item (Item_Id)
);
